"use strict";(self["webpackChunkcnode"]=self["webpackChunkcnode"]||[]).push([[945],{6054:function(s,t,e){e.d(t,{Z:function(){return c}});var a=function(){var s=this,t=s._self._c;return t("div",{staticClass:"nav"},[t("div",{staticClass:"nav-inner"},[s._m(0),s._m(1),t("ul",{staticClass:"list"},[t("li",[t("router-link",{attrs:{to:"/"}},[s._v("首页")])],1),t("li",{on:{click:s.show}},[s._v("发布")]),t("li",[t("router-link",{attrs:{to:"/message/Unreadmessage"}},[s._v("消息"),t("span",{staticClass:"Unmessage"},[s._v(s._s(s.getcount))])])],1),t("li",[t("router-link",{attrs:{to:"/topic_collect/collect"}},[s._v("收藏")])],1),t("li",{directives:[{name:"show",rawName:"v-show",value:s.token,expression:"token"}]},[t("router-link",{attrs:{to:"/user/caobowen1224"}},[t("p",[s._v(s._s(s.token.loginname))])])],1),t("li",{directives:[{name:"show",rawName:"v-show",value:s.token,expression:"token"}]},[t("router-link",{attrs:{to:"/user/caobowen1224"}},[t("img",{staticClass:"img",attrs:{src:`${s.token.avatar_url}`,alt:""}})])],1),s.token?t("li",{on:{click:s.back}},[s._v("退出")]):t("li",[s._v("登录")])])])])},i=[function(){var s=this,t=s._self._c;return t("div",{staticClass:"logo"},[t("img",{attrs:{src:"https://static2.cnodejs.org/public/images/cnodejs_light.svg",alt:""}})])},function(){var s=this,t=s._self._c;return t("div",{staticClass:"search"},[t("input",{attrs:{type:"text"}})])}],o=(e(7658),{data(){return{token:null}},methods:{async back(){sessionStorage.removeItem("userInfo"),sessionStorage.removeItem("token"),await this.$router.push("/login")},show(){this.$store.commit("show")}},computed:{getcount(){return this.$store.state.count}},created(){this.token=sessionStorage.getItem("userInfo"),this.token=JSON.parse(this.token),this.$store.dispatch("getCount")}}),n=o,r=e(1001),l=(0,r.Z)(n,a,i,!1,null,null,null),c=l.exports},5945:function(s,t,e){e.r(t),e.d(t,{default:function(){return _}});var a=function(){var s=this,t=s._self._c;return t("div",[t("HeaderTop"),t("div",{staticClass:"messageTop"},[t("router-link",{attrs:{to:"/"}},[s._v("首页")]),s._v(" / "),t("span",[s._v("新消息")]),s._v(" "),t("el-button",{staticStyle:{"margin-left":"800px"},on:{click:s.allRead}},[s._v("全部已读")])],1),t("div",{staticClass:"messMain"},[s.hasnot_read_messages.length?t("div",{staticClass:"newmess"},[t("ul",s._l(s.hasnot_read_messages,(function(e){return t("li",{key:e.id},[t("router-link",{attrs:{to:`/user/${e.author.loginname}`}},[s._v(s._s(e.author.loginname))]),s._v(" "),t("span",{staticClass:"replytopic"},[s._v("回复了你的话题")]),s._v(" "),t("router-link",{attrs:{to:`/topic/${e.topic.id}`}},[s._v(s._s(e.topic.title))]),t("el-button",{staticStyle:{"margin-left":"578px",display:"inline-block"},on:{click:function(t){return s.readed(e.id)}}},[s._v("标记已读")])],1)})),0)]):t("div",{staticClass:"nomess"},[t("p",[s._v(" 无消息 ")])])]),t("div",{staticClass:"messBot"}),s._m(0),t("div",{staticClass:"messMain1"},[s.has_read_messages.length?t("div",{staticClass:"newmess1"},[t("ul",s._l(s.has_read_messages,(function(e){return t("li",{key:e.id},[t("router-link",{attrs:{to:`/user/${e.author.loginname}`}},[s._v(s._s(e.author.loginname))]),s._v(" "),t("span",{staticClass:"replytopic"},[s._v("回复了你的话题")]),s._v(" "),t("router-link",{attrs:{to:`/topic/${e.topic.id}`}},[s._v(s._s(e.topic.title))])],1)})),0)]):t("div",{staticClass:"nomess1"},[t("p",[s._v(" 无消息 ")])])]),t("div",{staticClass:"messBot1"})],1)},i=[function(){var s=this,t=s._self._c;return t("div",{staticClass:"messageTop"},[t("span",[s._v("过往消息")])])}],o=(e(7658),e(6054)),n={components:{HeaderTop:o.Z},data(){return{has_read_messages:[],hasnot_read_messages:[]}},async created(){const s=await this.$http.get(`/messages?accesstoken=${sessionStorage.getItem("token")}`);this.has_read_messages=s.data.has_read_messages,this.hasnot_read_messages=s.data.hasnot_read_messages},methods:{async allRead(){await this.$http({method:"POST",url:"/message/mark_all",data:{accesstoken:sessionStorage.getItem("token")}}),this.$store.commit("clearCount");let s=this.hasnot_read_messages=[];this.hasnot_read_messages=[],this.has_read_messages=this.has_read_message.concat(s)},async readed(s){await this.$http({method:"post",url:`/message/mark_one/${s}`,data:{accesstoken:sessionStorage.getItem("token")}}),this.$store.commit("reduceCount"),this.hasnot_read_messages=this.hasnot_read_messages.filter((t=>t.id!=s));let t=this.hasnot_read_messages.find((t=>t.id===s));this.has_read_messages.push(t)}}},r=n,l=e(1001),c=(0,l.Z)(r,a,i,!1,null,null,null),_=c.exports}}]);
//# sourceMappingURL=945.590b30dd.js.map