"use strict";(self["webpackChunkcnode"]=self["webpackChunkcnode"]||[]).push([[980],{6054:function(t,e,s){s.d(e,{Z:function(){return r}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"nav"},[e("div",{staticClass:"nav-inner"},[t._m(0),t._m(1),e("ul",{staticClass:"list"},[e("li",[e("router-link",{attrs:{to:"/"}},[t._v("首页")])],1),e("li",{on:{click:t.show}},[t._v("发布")]),e("li",[e("router-link",{attrs:{to:"/message/Unreadmessage"}},[t._v("消息"),e("span",{staticClass:"Unmessage"},[t._v(t._s(t.getcount))])])],1),e("li",[e("router-link",{attrs:{to:"/topic_collect/collect"}},[t._v("收藏")])],1),e("li",{directives:[{name:"show",rawName:"v-show",value:t.token,expression:"token"}]},[e("router-link",{attrs:{to:"/user/caobowen1224"}},[e("p",[t._v(t._s(t.token.loginname))])])],1),e("li",{directives:[{name:"show",rawName:"v-show",value:t.token,expression:"token"}]},[e("router-link",{attrs:{to:"/user/caobowen1224"}},[e("img",{staticClass:"img",attrs:{src:`${t.token.avatar_url}`,alt:""}})])],1),t.token?e("li",{on:{click:t.back}},[t._v("退出")]):e("li",[t._v("登录")])])])])},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"logo"},[e("img",{attrs:{src:"https://static2.cnodejs.org/public/images/cnodejs_light.svg",alt:""}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"search"},[e("input",{attrs:{type:"text"}})])}],i=(s(7658),{data(){return{token:null}},methods:{async back(){sessionStorage.removeItem("userInfo"),sessionStorage.removeItem("token"),await this.$router.push("/login")},show(){this.$store.commit("show")}},computed:{getcount(){return this.$store.state.count}},created(){this.token=sessionStorage.getItem("userInfo"),this.token=JSON.parse(this.token),this.$store.dispatch("getCount")}}),a=i,l=s(1001),c=(0,l.Z)(a,o,n,!1,null,null,null),r=c.exports},3980:function(t,e,s){s.r(e),s.d(e,{default:function(){return m}});var o=function(){var t=this,e=t._self._c;return e("div",[e("header-top"),t.info?e("div",{staticClass:"article"},[e("div",{staticClass:"title",domProps:{innerHTML:t._s(t.info.title)}}),e("div",{staticClass:"change"},[e("span",[t._v("发布于"+t._s(t.date))]),e("span",[t._v("作者"+t._s(t.info.author.loginname))]),e("span",[t._v(t._s(t.info.visit_count)+"次浏览")]),e("span",[t._v("来自"+t._s(t.info.tab))]),t.isCollect?e("el-button",{attrs:{type:"success"},on:{click:t.Uncollect}},[t._v("取消收藏")]):e("el-button",{on:{click:t.handlercollect}},[t._v("收藏主题")])],1),e("hr"),e("div",{domProps:{innerHTML:t._s(t.info.content)}})]):t._e(),t.rely?e("div",{staticClass:"panel"},[t.rely?e("div",{staticClass:"header"},[t._v(t._s(t.rely.length)+" 回复 "),e("span",{staticClass:"comment",on:{click:t.showComment}},[t._v(" 评论")])]):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:t.Comment,expression:"Comment"}],staticClass:"showComment"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.comtext,expression:"comtext"}],attrs:{type:"text"},domProps:{value:t.comtext},on:{input:function(e){e.target.composing||(t.comtext=e.target.value)}}}),t.relyComment1?e("el-button",{on:{click:t.rely_comment}},[t._v("回复评论")]):e("el-button",{on:{click:t.successComment}},[t._v("确定")]),e("el-button",{on:{click:t.close}},[t._v("关闭")])],1),t._l(t.rely,(function(s,o){return e("div",{key:s.id,staticClass:"reply"},[e("div",{staticClass:"head"},[e("img",{attrs:{src:s.author.avatar_url,alt:""}})]),e("div",{staticClass:"name"},[t._v(t._s(s.author.loginname)),e("span",{staticClass:"floor",staticStyle:{"margin-left":"10px",color:"blue"}},[t._v(t._s(o+1)+"楼")]),e("span",[t._v(" - ")]),e("span",{staticStyle:{"margin-left":"5px",color:"blue"}},[t._v(t._s(s.create_at))]),e("span",{staticClass:"reply_comment",on:{click:t.relyComment}},[t._v("回复评论")]),e("div",{staticClass:"up"},[e("span",{staticClass:"iconfont icon-dianzan1",on:{click:function(e){return t.uptopic(s.id)}}}),e("span",[t._v(t._s(s.ups.length))])])]),e("div",{staticClass:"content",domProps:{innerHTML:t._s(s.content)}})])}))],2):t._e()],1)},n=[],i=(s(7658),s(6054)),a={components:{HeaderTop:i.Z},data(){return{info:null,date:null,rely:[],Comment:!1,comtext:"",relyComment1:!1,isCollect:!1}},async created(){const t=await this.$http({method:"get",url:`/topic/${this.$route.params.topicId}?accesstoken=${sessionStorage.getItem("token")}`});this.info=t.data,console.log(this.info),this.rely=t.data.replies,this.isCollect=this.info.is_collect,this.date=this.$moment(`${t.data.create_at}`,"YYYYMMDD").fromNow(),this.rely.forEach((t=>{t.create_at=this.$moment(`${t.create_at}`,"YYYYMMDD").fromNow()}))},computed:{getCollect(){return console.log(this.isCollect),this.isCollect}},methods:{async handlercollect(){this.isCollect=!this.isCollect;const t=await this.$http({method:"post",url:"/topic_collect/collect",data:{accesstoken:sessionStorage.getItem("token"),topic_id:this.info.id}});console.log(t)},async Uncollect(){this.isCollect=!this.isCollect;const t=await this.$http({method:"post",url:"/topic_collect/de_collect",data:{accesstoken:sessionStorage.getItem("token"),topic_id:this.info.id}});console.log(t)},showComment(){this.Comment=!0,this.relyComment1=!1},relyComment(){this.Comment=!0,this.relyComment1=!0},successComment(){this.rely.push({author:{avatar_url:"https://avatars.githubusercontent.com/u/51047556?v=4&s=120",loginname:"caobowen1224"},content:'<div class="markdown-text"><p>'+this.comtext+"</p>\n</div>",create_at:this.$moment(`${this.$moment().format("YYYY-MM-DD HH:mm:ss")}`,"YYYYMMDD").fromNow(),is_uped:!1,reply_id:null,ups:Array(0)}),this.$http({method:"POST",url:`/topic/${this.info.id}/replies`,data:{accesstoken:sessionStorage.getItem("token"),content:this.comtext}}).then((t=>{sessionStorage.setItem("reply_id",t.reply_id)})),this.Comment=!1,this.comtext=""},close(){this.Comment=!1,this.comtext=""},rely_comment(){this.rely.push({author:{avatar_url:"https://avatars.githubusercontent.com/u/51047556?v=4&s=120",loginname:"caobowen1224"},content:'<div class="markdown-text"><p>'+this.comtext+"</p>\n</div>",create_at:this.$moment().format("YYYY-MM-DD HH:mm:ss"),is_uped:!1,reply_id:null,ups:Array(0)}),this.$http({method:"POST",url:`/topic/${this.info.id}/replies`,data:{accesstoken:sessionStorage.getItem("token"),content:`回复:${this.info.replies[0].author.loginname}:`+this.comtext,reply_id:sessionStorage.getItem("reply_id").toString()}}).then((t=>{console.log(t)})),this.Comment=!1,this.comtext=""},uptopic(t){let e=sessionStorage.getItem("token");this.$http({method:"post",url:`/reply/${t}/ups`,data:{accesstoken:e}}).then((t=>{sessionStorage.setItem("newRes",t.action)}));let s=sessionStorage.getItem("newRes");"down"==s?this.rely.find((e=>e.id===t)).ups.push(`${e}`):this.rely.find((e=>e.id===t)).ups.splice(0,1)}}},l=a,c=s(1001),r=(0,c.Z)(l,o,n,!1,null,null,null),m=r.exports}}]);
//# sourceMappingURL=980.be2b707f.js.map